<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="UTF-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <link rel="icon" type="image/x-icon" href="assets/favicon.ico">
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.1.1/dist/css/bootstrap.min.css" rel="stylesheet"
    integrity="sha384-F3w7mX95PdgyTmZZMECAngseQB83DfGTowi0iMjiWaeVhAn4FJkqJByhZMI3AhiU" crossorigin="anonymous">
  <link rel="stylesheet" href="game.css">
  <title>Rock Paper Scissors</title>
</head>

<body>
  <header class="my-md-3 d-flex align-items-center">
    <button class="btn btn-back"><a class="btn-back-link display-2 fw-bold text-decoration-none"
        href="index.html">&lt;</a></button>
    <img class="logo" src="assets/logo.png" alt="logo">
    <p class="text-title h2 fw-bold text-uppercase">&nbsp; rock paper scissors</p>
  </header>
  <main class="container mx-auto">
    <div class="row row-cols-3 text-center">
      <div class="col my-md-2">
        <p class="h2 fw-bold text-uppercase">player 1</p>
      </div>
      <div class="col my-md-2"></div>
      <div class="col my-md-2">
        <p class="h2 fw-bold text-uppercase">COM</p>
      </div>
      <div class="col my-md-3">
        <button class="btn btn-play player" id="player-batu">
          <img src="assets/batu.png" alt="batu" width="100px" class="batu p-img" id="p_batu">
        </button>
      </div>
      <div class="col my-md-3"></div>
      <div class="col my-md-3">
        <button class="btn btn-play pe-none com" id="com-batu">
          <img src="assets/batu.png" alt="batu" width="100px" class="batu" id="c_batu">
        </button>
      </div>
      <div class="col my-md-3">
        <button class="btn btn-play player" id="player-kertas">
          <img src="assets/kertas.png" alt="kertas" width="100px" class="kertas p-img" id="p_kertas">
        </button>
      </div>
      <div class="col middle text-center my-md-3">
        <div class="area-middle">
          <p class="text-middle text-uppercase">vs</p>
        </div>
      </div>
      <div class="col my-md-3">
        <button class="btn btn-play pe-none com" id="com-kertas">
          <img src="assets/kertas.png" alt="kertas" width="100px" class="kertas" id="c_kertas">
        </button>
      </div>
      <div class="col my-md-3">
        <button class="btn btn-play player" id="player-gunting">
          <img src="assets/gunting.png" alt="gunting" width="100px" class="gunting p-img" id="p_gunting">
        </button>
      </div>
      <div class="col area-refresh my-md-3">
        <button class="btn">
          <img src="assets/refresh.png" alt="refresh" width="60px" id="refresh">
        </button>
        <p id="text-refresh"></p>
      </div>
      <div class="col my-md-3">
        <button class="btn btn-play pe-none com" id="com-gunting">
          <img src="assets/gunting.png" alt="gunting" width="100px" class="gunting" id="c_gunting">
        </button>
      </div>
    </div>
  </main>
  <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.1.1/dist/js/bootstrap.bundle.min.js"
    integrity="sha384-/bQdsTh/da6pkI1MST/rWKFNjaCP5gBSY4sEBT38Q/9RBh9AH40zEOg7Hlq2THRZ" crossorigin="anonymous">
  </script>
  <script>
    const p_batu = document.getElementById("p_batu");
    const p_kertas = document.getElementById("p_kertas");
    const p_gunting = document.getElementById("p_gunting");

    const comBatuBg = document.getElementById("com-batu");
    const comKertasBg = document.getElementById("com-kertas");
    const comGuntingBg = document.getElementById("com-gunting");

    const area_middle = document.querySelector(".area-middle");
    const text_middle = document.querySelector(".text-middle");

    const refreshText = document.getElementById("text-refresh")
    const refreshPage = document.getElementById("refresh");

    function set(duration1, duration2, duration3) {
      setTimeout(() => {
        comBatuBg.style.background = "var(--btn-play-bg)";
        comBatuBg.style.borderRadius = "15%";
        setTimeout(() => {
          comBatuBg.style.background = "";
        }, 300)
      }, duration1)
      setTimeout(() => {
        comKertasBg.style.background = "var(--btn-play-bg)";
        comKertasBg.style.borderRadius = "15%";
        setTimeout(() => {
          comKertasBg.style.background = "";
        }, 300)
      }, duration2)
      setTimeout(() => {
        comGuntingBg.style.background = "var(--btn-play-bg)";
        comGuntingBg.style.borderRadius = "15%";
        setTimeout(() => {
          comGuntingBg.style.background = "";
        }, 300)
      }, duration3)
    }

    function scramble() {
      for (let i = 0; i < 10; i++) {
        if (i === 1) {
          set(300, 600, 900);
        } else if (i === 2) {
          set(1200, 1500, 1800);
        } else if (i === 3) {
          set(2100, 2400, 2700)
        } else if (i === 4) {
          set(3000, 3300, 3600)
        }
      }
    }

    function compare(comBg, computer, resultConsole, result, newClass, shuffle) {
      setTimeout(() => {
        comBg.style.background = "var(--btn-play-bg)";
        comBg.style.borderRadius = "15%";
        setTimeout(() => {
          if (shuffle === computer) {
            area_middle.className = newClass;
            text_middle.innerHTML = result;
            comBg.style.background = "var(--btn-play-bg)";
            comBg.style.borderRadius = "15%";
            console.log(resultConsole)
            setTimeout(() => {
              p_batu.className = "disable-click";
              p_kertas.className = "disable-click";
              p_gunting.className = "disable-click";
              refreshText.innerHTML = "Please refresh to play again";
            }, 1500)
          } else {
            comBg.style.background = "";
          }
        }, 300)
      }, 4000)

      if (shuffle === computer) {
        return;
      }
    }

    class player {
      batu() {
        p_batu.addEventListener("click", () => {
          console.log(p_batu.id)
          const comShuffle = [c_batu, c_kertas, c_gunting];
          const shuffle = comShuffle[Math.floor(Math.random() * comShuffle.length)].id;
          console.log(shuffle)

          set();
          scramble();
          compare(comBatuBg, "c_batu", "DRAW", "DRAW", "result-draw", shuffle);
          compare(comKertasBg, "c_kertas", "COM WINS", "COM <br> WINS", "result", shuffle);
          compare(comGuntingBg, "c_gunting", "PLAYER 1 WINS", "PLAYER 1 <br> WINS", "result", shuffle);
        })
      }

      kertas() {
        p_kertas.addEventListener("click", () => {
          console.log(p_kertas.id)
          const comShuffle = [c_batu, c_kertas, c_gunting];
          const shuffle = comShuffle[Math.floor(Math.random() * comShuffle.length)].id;
          console.log(shuffle)

          set();
          scramble();
          compare(comBatuBg, "c_batu", "PLAYER 1 WINS", "PLAYER 1 <br> WINS", "result", shuffle);
          compare(comKertasBg, "c_kertas", "DRAW", "DRAW", "result-draw", shuffle);
          compare(comGuntingBg, "c_gunting", "COM WINS", "COM <br> WINS", "result", shuffle);
        })
      }

      gunting() {
        p_gunting.addEventListener("click", () => {
          console.log(p_gunting.id)
          const comShuffle = [c_batu, c_kertas, c_gunting];
          const shuffle = comShuffle[Math.floor(Math.random() * comShuffle.length)].id;
          console.log(shuffle)

          set();
          scramble();
          compare(comBatuBg, "c_batu", "COM WINS", "COM <br> WINS", "result", shuffle);
          compare(comKertasBg, "c_kertas", "PLAYER 1 WINS", "PLAYER 1 <br> WINS", "result", shuffle);
          compare(comGuntingBg, "c_gunting", "DRAW", "DRAW", "result-draw", shuffle);
        })
      }

      playAgain() {
        refreshPage.addEventListener("click", () => {
          location.reload();
        })
      }
    }

    const play = new player();

    play.batu();
    play.kertas();
    play.gunting();
    play.playAgain();
  </script>
</body>

</html>